#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
print(d2)
ggsave(filename = "covid_plot.pdf",plot = d2,device = "pdf")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
ggplot(data = covid_data %>% filter(county=="Hennepin"),aes(x=cases_per_capita,y=daily_change)+geom_point()
ggplot(data = covid_data %>% filter(county=="Hennepin"),aes(x=cases_per_capita,y=daily_change))+geom_point()
ggplot(data = covid_data %>% filter(county=="Hennepin"),aes(x=date,y=daily_change))+geom_point()
ggplot(data = covid_data %>% filter(county=="Hennepin"),aes(x=date,y=cases_per_capita))+geom_point()
covid_data <- covid_data %>%
group_by(county) %>%
mutate(daily_change = drv(cases_per_capita))
ggplot(data = covid_data %>% filter(county=="Hennepin"),aes(x=date,y=daily_change))+geom_point()
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth() +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_smooth() +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
theme_classic()
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
print(d2)
ggsave(filename = "covid_plot.pdf",plot = d2,device = "pdf")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
theme_set(theme_classic())
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
print(d2)
ggsave(filename = "covid_plot.pdf",plot = d2,device = "pdf")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
library(tidyverse)
library(lubridate)
theme_set(theme_classic())
covid_data <- read.csv('/Users/larsenb/Documents/BenProjects/covid19/covid-19-data/us-counties.csv')
covid_data$date<-as.Date(covid_data$date)
covid_data <- covid_data %>%
filter(county %in% c("Philadelphia","Cook","Hennepin")) %>%
filter(date > as.Date("2020-02-29"))
cook_population <- 5211000
philly_population <- 1581000
hennepin_population <- 1252000
covid_data$population[covid_data$county == "Cook"] <- cook_population
covid_data$population[covid_data$county == "Philadelphia"] <- philly_population
covid_data$population[covid_data$county == "Hennepin"] <- hennepin_population
covid_data <- covid_data %>%
mutate(cases_per_capita = cases/population) %>%
mutate(deaths_per_capita = deaths/population)
philly_lockdown <- as.Date("2020-03-16")
cook_lockdown <- as.Date("2020-03-21")
hennepin_lockdown <- as.Date("2020-03-24")
drv <- function(x) c(NA, diff(x))
covid_data <- covid_data %>%
group_by(county) %>%
mutate(daily_change = drv(cases_per_capita))
# covid_data$cases_per_capita <- covid_data$cases
# covid_data$cases_per_capita[covid_data$county == "Cook"] <- covid_data$cases[covid_data$county == "Cook"]/cook_population
# covid_data$cases_per_capita[covid_data$county == "Philadelphia"] <- covid_data$cases[covid_data$county == "Philadelphia"]/philly_population
# covid_data$cases_per_capita[covid_data$county == "Hennepin"] <- covid_data$cases[covid_data$county == "Hennepin"]/hennepin_population
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
print(d2)
ggsave(filename = "covid_plot.pdf",plot = d2,device = "pdf")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
print(dp)
covid_data$date
libryary(cowplot)
library(cowplot)
plot_grid(d2, dp, labels = "AUTO")
plot_grid(d2, dp, labels = "AUTO",nrow = 2)
print(combo_plot)
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
combo_plot <- cowplot::plot_grid(d2, dp, labels = "AUTO",nrow = 2)
print(combo_plot)
ggsave(filename = "covid_plot.pdf",plot = combo_plot,device = "pdf")
combo_plot <- cowplot::plot_grid(d2, dp, labels = "AUTO",nrow = 2)
combo_plot
print(combo_plot)
print(combo_plot)
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
clear
library(tidyverse)
library(lubridate)
theme_set(theme_classic())
covid_data <- read.csv('/Users/larsenb/Documents/BenProjects/covid19/covid-19-data/us-counties.csv')
covid_data$date<-as.Date(covid_data$date)
covid_data <- covid_data %>%
filter(county %in% c("Philadelphia","Cook","Hennepin")) %>%
filter(date > as.Date("2020-02-29"))
cook_population <- 5211000
philly_population <- 1581000
hennepin_population <- 1252000
covid_data$population[covid_data$county == "Cook"] <- cook_population
covid_data$population[covid_data$county == "Philadelphia"] <- philly_population
covid_data$population[covid_data$county == "Hennepin"] <- hennepin_population
covid_data <- covid_data %>%
mutate(cases_per_capita = cases/population) %>%
mutate(deaths_per_capita = deaths/population)
philly_lockdown <- as.Date("2020-03-16")
cook_lockdown <- as.Date("2020-03-21")
hennepin_lockdown <- as.Date("2020-03-24")
drv <- function(x) c(NA, diff(x))
covid_data <- covid_data %>%
group_by(county) %>%
mutate(daily_change = drv(cases_per_capita))
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
combo_plot <- cowplot::plot_grid(d2, dp, labels = "AUTO",nrow = 2)
#
print(combo_plot)
combo_plot
ggsave(filename = "covid_plot.pdf",plot = combo_plot,device = "pdf")
combo_plot$data
#
print(combo_plot)
combo_plot
ggsave(filename = "covid_plot.pdf",plot = combo_plot,device = "pdf",width = "20cm", height = "30cm")
ggsave(filename = "covid_plot.pdf",plot = combo_plot,device = "pdf",width = 20, height = 30, units = "cm")
ggsave(filename = "covid_plot.pdf",plot = combo_plot,device = "tif",width = 10, height = 15, units = "cm")
?ggsave()
ggsave(filename = "covid_plot.tif",plot = combo_plot,device = "tiff",width = 10, height = 15, units = "cm")
theme_set(theme_classic(),base.size=12)
library(tidyverse)
library(lubridate)
theme_set(theme_classic(base_size = 12),)
library(tidyverse)
library(lubridate)
theme_set(theme_classic(base_size = 12))
set()
library(tidyverse)
library(lubridate)
theme_set(theme_classic(base_size = 12))
covid_data <- read.csv('/Users/larsenb/Documents/BenProjects/covid19/covid-19-data/us-counties.csv')
covid_data$date<-as.Date(covid_data$date)
covid_data <- covid_data %>%
filter(county %in% c("Philadelphia","Cook","Hennepin")) %>%
filter(date > as.Date("2020-02-29"))
cook_population <- 5211000
philly_population <- 1581000
hennepin_population <- 1252000
covid_data$population[covid_data$county == "Cook"] <- cook_population
covid_data$population[covid_data$county == "Philadelphia"] <- philly_population
covid_data$population[covid_data$county == "Hennepin"] <- hennepin_population
covid_data <- covid_data %>%
mutate(cases_per_capita = cases/population) %>%
mutate(deaths_per_capita = deaths/population)
philly_lockdown <- as.Date("2020-03-16")
cook_lockdown <- as.Date("2020-03-21")
hennepin_lockdown <- as.Date("2020-03-24")
drv <- function(x) c(NA, diff(x))
covid_data <- covid_data %>%
group_by(county) %>%
mutate(daily_change = drv(cases_per_capita))
# ggplot(data = covid_data,aes(x=date,y=cases,fill=county))+geom_bar(stat = "identity",position = "dodge")
# ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
#   scale_fill_manual(values = c("red","darkorchid1","blue")) +
#   geom_vline(xintercept = philly_lockdown,color="blue") +
#   geom_vline(xintercept = cook_lockdown,color = "red") +
#   geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1")
ggplot(data = covid_data,aes(x=date,y=cases_per_capita,fill=county,color=county, label= ifelse(deaths>0,paste(deaths,"deaths",sep=" "),""))) +
geom_point() + geom_line() + geom_smooth(se = F,alpha = .5) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue") +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(nudge_y = .00001,show.legend = F)
d <- ggplot(data = covid_data,aes(x=date,y=deaths_per_capita,fill=county))+geom_bar(stat = "identity",position = "dodge") +
scale_fill_manual(values = c("red","darkorchid1","blue"))
d2 <- d +
geom_point(aes(y = cases_per_capita,color = county)) + geom_line(aes(y = cases_per_capita,color = county)) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(cases_per_capita),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(cases_per_capita),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(cases_per_capita),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Per Capita (Line = cases, Bar = deaths)",x="Date",title = "COVID-19 Cases and Deaths per Capita")
dp <- ggplot(data = covid_data,aes(x=date,y=daily_change,color = county)) +
geom_point() + geom_line() + geom_smooth(se = F) +
scale_color_manual(values = c("red","darkorchid1","blue")) +
geom_vline(xintercept = philly_lockdown,color="blue",show.legend = T) +
geom_text(aes(x=philly_lockdown-1, y=.8*max(daily_change),label="Philly lockdown"),
colour="blue", angle=90) +
geom_vline(xintercept = cook_lockdown,color = "red") +
geom_text(aes(x=cook_lockdown-1, y=.8*max(daily_change),label="Cook lockdown"),
colour="red", angle=90) +
geom_vline(xintercept = hennepin_lockdown,color = "darkorchid1") +
geom_text(aes(x=hennepin_lockdown-1, y=.8*max(daily_change),label="Hennepin lockdown"),
colour="darkorchid1", angle=90) +
labs(y = "Daily change in cases per capita",x="Date",title = "COVID-19: Change in Cases per Capita")
combo_plot <- cowplot::plot_grid(d2, dp, labels = "AUTO",nrow = 2)
#
print(combo_plot)
combo_plot
ggsave(filename = "covid_plot.tif",plot = combo_plot,device = "tiff",width = 10, height = 15, units = "cm")
cowplot::save_plot(filename = "covid_plot.tif",plot = combo_plot,base_height = 20,base_width = 15)
cowplot::save_plot(filename = "covid_plot.tif",plot = combo_plot,base_height = 20,base_width = 15,)
cowplot::save_plot(filename = "covid_plot.png",plot = combo_plot,base_height = 20,base_width = 15,)
cowplot::save_plot(filename = "covid_plot.png",plot = combo_plot,base_height = 20,base_width = 15)
cowplot::save_plot(filename = "covid_plot.png",plot = combo_plot,base_height = 10,base_width = 7.5)
!["plot"]("covid_plot.png")
![alt text here](path-to-image-here)
include_graphics("covid_plot.png")
knitr::include_graphics("covid_plot.png")
